import accordionDark from 'url:../assets/component-illustrations/dark/components/accordion.png';
import accordionLight from 'url:../assets/component-illustrations/light/components/accordion.png';
// @ts-ignore
import actionBarDark from 'url:../assets/component-illustrations/dark/components/action-bar.png';

// Background gradients
import actionBarLight from 'url:../assets/component-illustrations/light/components/action-bar.png';
import actionButtonDark from 'url:../assets/component-illustrations/dark/components/action-button.png';
import actionButtonLight from 'url:../assets/component-illustrations/light/components/action-button.png';
import actionGroupDark from 'url:../assets/component-illustrations/dark/components/action-group.png';
import actionGroupLight from 'url:../assets/component-illustrations/light/components/action-group.png';

// Light mode component illustrations
import actionMenuDark from 'url:../assets/component-illustrations/dark/components/action-menu.png';
import actionMenuLight from 'url:../assets/component-illustrations/light/components/action-menu.png';
// @ts-ignore
import AdobeDefaultSvg from '@react-spectrum/docs/pages/assets/component-illustrations/AdobeDefault.svg';
import avatarDark from 'url:../assets/component-illustrations/dark/components/avatar.png';
import avatarGroupDark from 'url:../assets/component-illustrations/dark/components/avatar-group.png';
import avatarGroupLight from 'url:../assets/component-illustrations/light/components/avatar-group.png';
import avatarLight from 'url:../assets/component-illustrations/light/components/avatar.png';
import backgroundDark from 'url:../assets/component-illustrations/dark/gradient-bg.png';
import backgroundLight from 'url:../assets/component-illustrations/light/gradient-bg.png';
import badgeDark from 'url:../assets/component-illustrations/dark/components/badge.png';
import badgeLight from 'url:../assets/component-illustrations/light/components/badge.png';
import breadcrumbsDark from 'url:../assets/component-illustrations/dark/components/breadcrumbs.png';
import breadcrumbsLight from 'url:../assets/component-illustrations/light/components/breadcrumbs.png';
import buttonDark from 'url:../assets/component-illustrations/dark/components/button.png';
import buttonGroupDark from 'url:../assets/component-illustrations/dark/components/button-group.png';
import buttonGroupLight from 'url:../assets/component-illustrations/light/components/button-group.png';
import buttonLight from 'url:../assets/component-illustrations/light/components/button.png';
import calendarDark from 'url:../assets/component-illustrations/dark/components/calendar.png';
import calendarLight from 'url:../assets/component-illustrations/light/components/calendar.png';
import {Card, CardPreview, CardProps, Content, Text} from '@react-spectrum/s2';
import cardsDark from 'url:../assets/component-illustrations/dark/components/cards.png';
import cardsLight from 'url:../assets/component-illustrations/light/components/cards.png';
import cardsViewDark from 'url:../assets/component-illustrations/dark/components/cards-view.png';
import cardsViewLight from 'url:../assets/component-illustrations/light/components/cards-view.png';
import checkboxDark from 'url:../assets/component-illustrations/dark/components/checkbox.png';
import checkboxGroupDark from 'url:../assets/component-illustrations/dark/components/checkbox-group.png';
import checkboxGroupLight from 'url:../assets/component-illustrations/light/components/checkbox-group.png';
import checkboxLight from 'url:../assets/component-illustrations/light/components/checkbox.png';
import clientSideRoutingDark from 'url:../assets/component-illustrations/dark/guides/client-side-routing.png';
import clientSideRoutingLight from 'url:../assets/component-illustrations/light/guides/client-side-routing.png';
import collectionDark from 'url:../assets/component-illustrations/dark/guides/collection.png';
import collectionLight from 'url:../assets/component-illustrations/light/guides/collection.png';
import colorAreaDark from 'url:../assets/component-illustrations/dark/components/color-area.png';
import colorAreaLight from 'url:../assets/component-illustrations/light/components/color-area.png';
import colorFieldDark from 'url:../assets/component-illustrations/dark/components/color-field.png';
import colorFieldLight from 'url:../assets/component-illustrations/light/components/color-field.png';
import colorSliderDark from 'url:../assets/component-illustrations/dark/components/color-slider.png';
import colorSliderLight from 'url:../assets/component-illustrations/light/components/color-slider.png';
import colorWheelDark from 'url:../assets/component-illustrations/dark/components/color-wheel.png';
import colorWheelLight from 'url:../assets/component-illustrations/light/components/color-wheel.png';
import comboBoxDark from 'url:../assets/component-illustrations/dark/components/combo-box.png';
import comboBoxLight from 'url:../assets/component-illustrations/light/components/combo-box.png';
import contextualHelpDark from 'url:../assets/component-illustrations/dark/components/contextual-help.png';
import contextualHelpLight from 'url:../assets/component-illustrations/light/components/contextual-help.png';
import dateAndTimeDark from 'url:../assets/component-illustrations/dark/components/date-and-time.png';
import dateAndTimeLight from 'url:../assets/component-illustrations/light/components/date-and-time.png';
import dateAndTimeRangeDark from 'url:../assets/component-illustrations/dark/components/date-and-time(range).png';
import dateAndTimeRangeLight from 'url:../assets/component-illustrations/light/components/date-and-time(range).png';
import dateFieldDark from 'url:../assets/component-illustrations/dark/components/date-field.png';
import dateFieldLight from 'url:../assets/component-illustrations/light/components/date-field.png';
import dialogDark from 'url:../assets/component-illustrations/dark/components/dialog.png';
import dialogLight from 'url:../assets/component-illustrations/light/components/dialog.png';
import disclosureDark from 'url:../assets/component-illustrations/dark/components/disclosure.png';
import disclosureLight from 'url:../assets/component-illustrations/light/components/disclosure.png';
import dividerDark from 'url:../assets/component-illustrations/dark/components/divider.png';
import dividerLight from 'url:../assets/component-illustrations/light/components/divider.png';
import dropZoneDark from 'url:../assets/component-illustrations/dark/components/drop-zone.png';
import dropZoneLight from 'url:../assets/component-illustrations/light/components/drop-zone.png';
import {ExampleImage} from './ExampleList';
import formsDark from 'url:../assets/component-illustrations/dark/guides/forms.png';
import formsLight from 'url:../assets/component-illustrations/light/guides/forms.png';
import gettingStartedDark from 'url:../assets/component-illustrations/dark/guides/getting-started.png';
import gettingStartedLight from 'url:../assets/component-illustrations/light/guides/getting-started.png';
import iconsDark from 'url:../assets/component-illustrations/dark/components/icons.png';
import iconsLight from 'url:../assets/component-illustrations/light/components/icons.png';
import illustratedMessageDark from 'url:../assets/component-illustrations/dark/components/illustrated-message.png';
import illustratedMessageLight from 'url:../assets/component-illustrations/light/components/illustrated-message.png';

// Dark mode component illustrations
import illustrationsDark from 'url:../assets/component-illustrations/dark/components/illustrations.png';
import illustrationsLight from 'url:../assets/component-illustrations/light/components/illustrations.png';
// @ts-ignore
import imagesDark from 'url:../assets/component-illustrations/dark/components/images.png';
import imagesLight from 'url:../assets/component-illustrations/light/components/images.png';
import inlineAlertDark from 'url:../assets/component-illustrations/dark/components/in-line-alert.png';
import inlineAlertLight from 'url:../assets/component-illustrations/light/components/in-line-alert.png';
// @eslint-disable-next-line
import InternationalizedDefaultSvg from '@react-spectrum/docs/pages/assets/component-illustrations/InternationalizedDefault.svg';
import linkButtonDark from 'url:../assets/component-illustrations/dark/components/link-button.png';
import linkButtonLight from 'url:../assets/component-illustrations/light/components/link-button.png';
import linkDark from 'url:../assets/component-illustrations/dark/components/link.png';
import linkLight from 'url:../assets/component-illustrations/light/components/link.png';
import mcpServerDark from 'url:../assets/component-illustrations/dark/guides/mcp-server.png';
import mcpServerLight from 'url:../assets/component-illustrations/light/guides/mcp-server.png';
import menuDark from 'url:../assets/component-illustrations/dark/components/menu.png';
import menuLight from 'url:../assets/component-illustrations/light/components/menu.png';
import meterDark from 'url:../assets/component-illustrations/dark/components/meter.png';
import meterLight from 'url:../assets/component-illustrations/light/components/meter.png';
import numberFieldDark from 'url:../assets/component-illustrations/dark/components/number-field.png';
import numberFieldLight from 'url:../assets/component-illustrations/light/components/number-field.png';
import {Page} from '@parcel/rsc';
import pickerDark from 'url:../assets/component-illustrations/dark/components/picker.png';
import pickerLight from 'url:../assets/component-illustrations/light/components/picker.png';
import popoverDark from 'url:../assets/component-illustrations/dark/components/popover.png';
import popoverLight from 'url:../assets/component-illustrations/light/components/popover.png';
import progressBarDark from 'url:../assets/component-illustrations/dark/components/progress-bar.png';
import progressBarLight from 'url:../assets/component-illustrations/light/components/progress-bar.png';
import progressCircleDark from 'url:../assets/component-illustrations/dark/components/progress-circle.png';
import progressCircleLight from 'url:../assets/component-illustrations/light/components/progress-circle.png';
import providerDark from 'url:../assets/component-illustrations/dark/components/provider.png';
import providerLight from 'url:../assets/component-illustrations/light/components/provider.png';
import radioGroupDark from 'url:../assets/component-illustrations/dark/components/radio-group.png';
import radioGroupLight from 'url:../assets/component-illustrations/light/components/radio-group.png';
import rangeCalendarDark from 'url:../assets/component-illustrations/dark/components/range-calendar.png';
import rangeCalendarLight from 'url:../assets/component-illustrations/light/components/range-calendar.png';
import React from 'react';
// @eslint-disable-next-line
import ReactAriaDefaultSvg from '@react-spectrum/docs/pages/assets/component-illustrations/ReactAriaDefault.svg';
import searchFieldDark from 'url:../assets/component-illustrations/dark/components/search-field.png';
import searchFieldLight from 'url:../assets/component-illustrations/light/components/search-field.png';
import segmentedControlDark from 'url:../assets/component-illustrations/dark/components/segmented-control.png';
import segmentedControlLight from 'url:../assets/component-illustrations/light/components/segmented-control.png';
import selectBoxDark from 'url:../assets/component-illustrations/dark/components/select-box.png';
import selectBoxLight from 'url:../assets/component-illustrations/light/components/select-box.png';
import selectionDark from 'url:../assets/component-illustrations/dark/guides/selection.png';
import selectionLight from 'url:../assets/component-illustrations/light/guides/selection.png';
import skeletonDark from 'url:../assets/component-illustrations/dark/components/skeleton.png';
import skeletonLight from 'url:../assets/component-illustrations/light/components/skeleton.png';
import sliderDark from 'url:../assets/component-illustrations/dark/components/slider.png';
import sliderLight from 'url:../assets/component-illustrations/light/components/slider.png';
import sliderRangeDark from 'url:../assets/component-illustrations/dark/components/slider(range).png';
import sliderRangeLight from 'url:../assets/component-illustrations/light/components/slider(range).png';
import statusLightDark from 'url:../assets/component-illustrations/dark/components/status-light.png';
import statusLightLight from 'url:../assets/component-illustrations/light/components/status-light.png';
import {style} from '@react-spectrum/s2/style' with { type: 'macro' };
import styleDark from 'url:../assets/component-illustrations/dark/guides/style.png';
import styleLight from 'url:../assets/component-illustrations/light/guides/style.png';
import styleMacroDark from 'url:../assets/component-illustrations/dark/guides/style-macro.png';
import styleMacroLight from 'url:../assets/component-illustrations/light/guides/style-macro.png';
import swatchDark from 'url:../assets/component-illustrations/dark/components/swatch.png';
import swatchGroupDark from 'url:../assets/component-illustrations/dark/components/swatch-group.png';
import swatchGroupLight from 'url:../assets/component-illustrations/light/components/swatch-group.png';
import swatchLight from 'url:../assets/component-illustrations/light/components/swatch.png';
import switchDark from 'url:../assets/component-illustrations/dark/components/switch.png';
import switchLight from 'url:../assets/component-illustrations/light/components/switch.png';
import tableDark from 'url:../assets/component-illustrations/dark/components/table.png';
import tableLight from 'url:../assets/component-illustrations/light/components/table.png';
import tabsDark from 'url:../assets/component-illustrations/dark/components/tabs.png';
import tabsLight from 'url:../assets/component-illustrations/light/components/tabs.png';
import tagGroupDark from 'url:../assets/component-illustrations/dark/components/tag-group.png';
import tagGroupLight from 'url:../assets/component-illustrations/light/components/tag-group.png';

// Light mode guide illustrations
import textAreaDark from 'url:../assets/component-illustrations/dark/components/text-area.png';
import textAreaLight from 'url:../assets/component-illustrations/light/components/text-area.png';
import textFieldDark from 'url:../assets/component-illustrations/dark/components/text-field.png';
import textFieldLight from 'url:../assets/component-illustrations/light/components/text-field.png';
import timeFieldDark from 'url:../assets/component-illustrations/dark/components/time-field.png';
import timeFieldLight from 'url:../assets/component-illustrations/light/components/time-field.png';
import toastDark from 'url:../assets/component-illustrations/dark/components/toast.png';
import toastLight from 'url:../assets/component-illustrations/light/components/toast.png';

// Dark mode guide illustrations
import toggleButtonDark from 'url:../assets/component-illustrations/dark/components/toggle-button.png';
import toggleButtonGroupDark from 'url:../assets/component-illustrations/dark/components/toggle-button-group.png';
import toggleButtonGroupLight from 'url:../assets/component-illustrations/light/components/toggle-button-group.png';
import toggleButtonLight from 'url:../assets/component-illustrations/light/components/toggle-button.png';
import tooltipDark from 'url:../assets/component-illustrations/dark/components/tooltip.png';
import tooltipLight from 'url:../assets/component-illustrations/light/components/tooltip.png';
import treeViewDark from 'url:../assets/component-illustrations/dark/components/tree-view.png';
import treeViewLight from 'url:../assets/component-illustrations/light/components/tree-view.png';

export interface ComponentCardItem {
  id: string,
  name: string,
  href: string
}

// Mapping from component names to their illustration [light, dark] tuple
const componentIllustrations: Record<string, [string, string] | undefined> = {
  // Components
  'Accordion': [accordionLight, accordionDark],
  'ActionBar': [actionBarLight, actionBarDark],
  'ActionButton': [actionButtonLight, actionButtonDark],
  'ActionButtonGroup': [buttonGroupLight, buttonGroupDark],
  'ActionGroup': [actionGroupLight, actionGroupDark],
  'ActionMenu': [actionMenuLight, actionMenuDark],
  'Avatar': [avatarLight, avatarDark],
  'AvatarGroup': [avatarGroupLight, avatarGroupDark],
  'Badge': [badgeLight, badgeDark],
  'Breadcrumbs': [breadcrumbsLight, breadcrumbsDark],
  'Button': [buttonLight, buttonDark],
  'ButtonGroup': [buttonGroupLight, buttonGroupDark],
  'Calendar': [calendarLight, calendarDark],
  'Card': [cardsLight, cardsDark],
  'CardView': [cardsViewLight, cardsViewDark],
  'Checkbox': [checkboxLight, checkboxDark],
  'CheckboxGroup': [checkboxGroupLight, checkboxGroupDark],
  'ColorArea': [colorAreaLight, colorAreaDark],
  'ColorField': [colorFieldLight, colorFieldDark],
  'ColorSlider': [colorSliderLight, colorSliderDark],
  'ColorSwatch': [swatchLight, swatchDark],
  'ColorSwatchPicker': [swatchGroupLight, swatchGroupDark],
  'ColorWheel': [colorWheelLight, colorWheelDark],
  'ComboBox': [comboBoxLight, comboBoxDark],
  'ContextualHelp': [contextualHelpLight, contextualHelpDark],
  'DateField': [dateFieldLight, dateFieldDark],
  'DatePicker': [dateAndTimeLight, dateAndTimeDark],
  'DateRangePicker': [dateAndTimeRangeLight, dateAndTimeRangeDark],
  'Dialog': [dialogLight, dialogDark],
  'Disclosure': [disclosureLight, disclosureDark],
  'DisclosureGroup': [accordionLight, accordionDark],
  'Divider': [dividerLight, dividerDark],
  'DropZone': [dropZoneLight, dropZoneDark],
  'Icons': [iconsLight, iconsDark],
  'IllustratedMessage': [illustratedMessageLight, illustratedMessageDark],
  'Illustrations': [illustrationsLight, illustrationsDark],
  'Image': [imagesLight, imagesDark],
  'InlineAlert': [inlineAlertLight, inlineAlertDark],
  'Link': [linkLight, linkDark],
  'LinkButton': [linkButtonLight, linkButtonDark],
  'Menu': [menuLight, menuDark],
  'Meter': [meterLight, meterDark],
  'NumberField': [numberFieldLight, numberFieldDark],
  'Picker': [pickerLight, pickerDark],
  'Popover': [popoverLight, popoverDark],
  'ProgressBar': [progressBarLight, progressBarDark],
  'ProgressCircle': [progressCircleLight, progressCircleDark],
  'Provider': [providerLight, providerDark],
  'RadioGroup': [radioGroupLight, radioGroupDark],
  'RangeCalendar': [rangeCalendarLight, rangeCalendarDark],
  'RangeSlider': [sliderRangeLight, sliderRangeDark],
  'SearchField': [searchFieldLight, searchFieldDark],
  'SegmentedControl': [segmentedControlLight, segmentedControlDark],
  'Select': [pickerLight, pickerDark],
  'SelectBoxGroup': [selectBoxLight, selectBoxDark],
  'Skeleton': [skeletonLight, skeletonDark],
  'Slider': [sliderLight, sliderDark],
  'StatusLight': [statusLightLight, statusLightDark],
  'Switch': [switchLight, switchDark],
  'Table': [tableLight, tableDark],
  'TableView': [tableLight, tableDark],
  'Tabs': [tabsLight, tabsDark],
  'TagGroup': [tagGroupLight, tagGroupDark],
  'TextArea': [textAreaLight, textAreaDark],
  'TextField': [textFieldLight, textFieldDark],
  'TimeField': [timeFieldLight, timeFieldDark],
  'Toast': [toastLight, toastDark],
  'ToggleButton': [toggleButtonLight, toggleButtonDark],
  'ToggleButtonGroup': [toggleButtonGroupLight, toggleButtonGroupDark],
  'Tooltip': [tooltipLight, tooltipDark],
  'Tree': [treeViewLight, treeViewDark],
  'TreeView': [treeViewLight, treeViewDark],
  // Guides
  'Collections': [collectionLight, collectionDark],
  'Forms': [formsLight, formsDark],
  'Selection': [selectionLight, selectionDark],
  'MCP Server': [mcpServerLight, mcpServerDark],
  'Styling': [styleLight, styleDark],
  'Style Macro': [styleMacroLight, styleMacroDark],
  'Getting Started': [gettingStartedLight, gettingStartedDark],
  'Client Side Routing': [clientSideRoutingLight, clientSideRoutingDark]
};

const illustrationContainer = style({
  width: 'full',
  aspectRatio: '4/3',
  display: 'flex',
  alignItems: 'center',
  justifyContent: 'center',
  minHeight: 0,
  overflow: 'hidden',
  position: 'relative'
});

const backgroundStyles = style({
  position: 'absolute',
  inset: 0,
  width: 'full',
  height: 'full',
  objectFit: 'cover',
  userSelect: 'none',
  pointerEvents: 'none'
});

const illustrationStyles = style({
  position: 'relative',
  width: 'full',
  height: 'full',
  objectFit: 'cover',
  userSelect: 'none',
  pointerEvents: 'none'
});

const placeholderContainer = style({
  width: 'full',
  aspectRatio: '4/3',
  backgroundColor: '--anatomy-gray-100',
  display: 'flex',
  alignItems: 'center',
  justifyContent: 'center'
});

const defaultIllustrationStyles = style({
  maxWidth: 'calc(100% - 16px)',
  maxHeight: 'calc(100% - 16px)',
  userSelect: 'none',
  pointerEvents: 'none'
});

function getDefaultIllustration(href: string) {
  if (href.includes('/internationalized/')) {
    return InternationalizedDefaultSvg;
  } else if (href.includes('/react-aria/')) {
    return ReactAriaDefaultSvg;
  }
  return AdobeDefaultSvg;
}

const releaseContainer = style({
  width: 'full',
  aspectRatio: '4/3',
  backgroundColor: '--anatomy-gray-100',
  display: 'flex',
  alignItems: 'center',
  justifyContent: 'center',
  minHeight: 0
});

const releaseText = style({
  font: 'heading-lg',
  color: '--anatomy-gray-900'
});

interface IllustrationProps {
  name: string,
  href: string
}

function ComponentIllustration({name, href}: IllustrationProps) {
  const illustration = componentIllustrations[name];

  if (!illustration) {
    // Return the default library logo for components without illustrations
    const DefaultIllustration = getDefaultIllustration(href);
    return (
      <div className={placeholderContainer}>
        <DefaultIllustration aria-hidden="true" className={defaultIllustrationStyles} />
      </div>
    );
  }

  const [light, dark] = illustration;

  return (
    <div className={illustrationContainer}>
      {/* Background gradient */}
      <picture>
        <source srcSet={backgroundLight} media="(prefers-color-scheme: light)" />
        <source srcSet={backgroundDark} media="(prefers-color-scheme: dark)" />
        <img
          src={backgroundLight}
          alt=""
          aria-hidden="true"
          className={backgroundStyles}
          loading="lazy" />
      </picture>
      {/* Component illustration */}
      <picture>
        <source srcSet={light} media="(prefers-color-scheme: light)" />
        <source srcSet={dark} media="(prefers-color-scheme: dark)" />
        <img
          src={light}
          alt=""
          aria-hidden="true"
          className={illustrationStyles}
          loading="lazy" />
      </picture>
    </div>
  );
}

function getReleaseVersionLabel(href: string) {
  let match = href.match(/releases\/(v[\w-]+)\.html$/i);
  if (!match) {
    return null;
  }
  return match[1].replace(/-/g, '.');
}

interface ComponentCardProps extends Omit<CardProps, 'children'> {
  name: string,
  href: string,
  description?: string
}

export function ComponentCard({id, name, href, description, size, ...otherProps}: ComponentCardProps) {
  let preview;
  let releaseVersion = getReleaseVersionLabel(href);

  if (releaseVersion) {
    preview = (
      <div className={releaseContainer}>
        <span className={releaseText}>{releaseVersion}</span>
      </div>
    );
  } else if (href.includes('react-aria/examples/') && !href.endsWith('index.html')) {
    preview = <ExampleImage name={href} />;
  } else {
    preview = <ComponentIllustration name={name} href={href} />;
  }

  return (
    <Card {...otherProps} id={id} href={href} size={size} textValue={name}>
      <CardPreview>
        {preview}
      </CardPreview>
      <Content>
        <Text slot="title">{name}</Text>
        {description && <Text slot="description">{description}</Text>}
      </Content>
    </Card>
  );
}

interface ComponentListProps {
  pages: Page[],
  components: string[]
}

export function ComponentList(props: ComponentListProps) {
  let pages = props.pages.filter(page => props.components.includes(page.name));
  return (
    <ul
      className={style({
        display: 'flex',
        gap: 24,
        listStyleType: 'none',
        overflow: 'auto',
        '--paddingX': {
          type: 'paddingStart',
          value: {
            default: 12,
            lg: 40
          }
        },
        paddingX: '--paddingX',
        marginX: {
          default: -12,
          lg: -40
        },
        paddingY: 20,
        marginY: -20,
        scrollSnapType: 'x',
        scrollPaddingX: '--paddingX'
      })}
      style={{
        maskImage: 'linear-gradient(to right, transparent, white var(--paddingX) calc(100% - var(--paddingX)), transparent)'
      }}>
      {pages.map(page => (
        <li key={page.url}>
          <ComponentCard name={getTitle(page)} href={page.url} size="S" UNSAFE_style={{scrollSnapAlign: 'start'}} />
        </li>
      ))}
    </ul>
  );
}

const getTitle = (page: Page) => page.tableOfContents?.[0]?.title ?? '';
